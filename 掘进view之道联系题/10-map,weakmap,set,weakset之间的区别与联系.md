# map,weakmap,set,weakset之间的区别与联系

## map

- 键/值对的集合，键可以是任何值（包括函数、对象或任何原语-原始数据类型）。

- 可以被枚举，for...of...。

## weakMap

- 是键/值对的集合，其键必须是对象-对象数据类型。

- 不允许被枚举。

- 无法被清空，没有clear()方法。

- *优处：*键名所引用的对象都是弱引用，一旦引用对象被删除，这个键值也会被垃圾回收。

```js
const e1 = document.getElementById('foo');
const e2 = document.getElementById('bar');
const arr = [
  [e1, 'foo 元素'],
  [e2, 'bar 元素'],
];
//e1和e2是两个对象，我们通过arr数组对这两个对象添加一些文字说明。这就形成了arr对e1和e2的引用。
//一旦不再需要这两个对象，我们就必须手动删除这个引用，否则垃圾回收机制就不会释放e1和e2占用的内存。

new WeakMap().set(e1, 'foo 元素').set(e2, 'bar 元素')
//一旦不再需要这两个对象，这两个引用就会被自动内存回收。
```

## set

- 值的集合，但每个值只能出现一次，值可以是任何值（包括函数、对象或任何原语-原始数据类型）。

- 可以被枚举，for...of...。

## weakSet

- 值的集合，值必须是对象-对象数据类型。

- 不允许被枚举。

- 无法被清空，没有clear()方法。

- *优处：*值所引用的对象都是弱引用，一旦引用对象被删除，这个值也会被垃圾回收。

```js
const e1 = document.getElementById('foo');
const e2 = document.getElementById('bar');
const arr = [e1, e2];
//e1和e2是两个对象，我们通过arr数组对e1和e2的引用。
//一旦不再需要这两个对象，我们就必须手动删除这个引用，否则垃圾回收机制就不会释放e1和e2占用的内存。

new WeakSet().add(e1).add(e2)
//一旦不再需要这两个对象，这两个引用就会被自动垃圾回收。
```

## 总结

- `weak`弱引用的最终是为了避开垃圾回收机制，让这些被引用的对象能够被垃圾回收。
